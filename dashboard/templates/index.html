<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading Bot Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1>Trading Bot Dashboard</h1>
            
            <div class="status-control">
                <div class="status-indicator">
                    <div id="status-dot" class="dot offline"></div>
                    <span id="status-text">Cargando...</span>
                </div>
                
                <div class="control-buttons">
                    <button id="start-btn" class="btn btn-primary" onclick="startBot()" disabled>
                        ‚ñ∂Ô∏è Iniciar
                    </button>
                    <button id="stop-btn" class="btn btn-danger" onclick="stopBot()" disabled>
                        ‚è∏Ô∏è Pausar
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Account Status -->
        <section class="card">
            <h2>üíº Estado de la Cuenta</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Balance</div>
                    <div class="stat-value" id="balance">‚Ç¨0.00</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Disponible</div>
                    <div class="stat-value" id="available">‚Ç¨0.00</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Margen Usado</div>
                    <div class="stat-value" id="margin-used">‚Ç¨0.00</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">% Margen</div>
                    <div class="stat-value" id="margin-percent">0.0%</div>
                </div>
            </div>
        </section>

        <!-- Open Positions -->
        <section class="card">
            <h2>üìä Posiciones Abiertas (<span id="positions-count">0</span>)</h2>
            <div id="positions-container" class="positions-container">
                <p class="loading">Cargando posiciones...</p>
            </div>
        </section>

        <!-- Trades History -->
        <section class="card">
            <h2>üìà Historial de Trades</h2>
            
            <div class="action-buttons" style="margin-bottom: 1.5rem;">
                <button class="btn btn-primary" onclick="exportTradesCSV()">
                    üìÑ EXPORTAR CSV
                </button>
                <button class="btn btn-primary" onclick="exportTradesExcel()">
                    üìä EXPORTAR EXCEL
                </button>
                <button class="btn btn-success" onclick="generateFullReport()">
                    üìë REPORTE COMPLETO
                </button>
            </div>

            <div class="form-group">
                <label class="form-label">Sesi√≥n:</label>
                <select id="session-filter" class="form-control">
                    <option value="">Todas las sesiones</option>
                </select>

                <label class="form-label">L√≠mite:</label>
                <select id="limit-filter" class="form-control">
                    <option value="50">50</option>
                    <option value="100">100</option>
                    <option value="200">200</option>
                    <option value="500">500</option>
                </select>

                <button class="btn btn-primary" onclick="loadTradesHistory()">
                    üîÑ ACTUALIZAR
                </button>
            </div>

            <div id="trades-container" class="table-container">
                <p class="loading">Cargando trades...</p>
            </div>
        </section>

        <!-- Statistics -->
        <section class="card">
            <h2>üìä Estad√≠sticas</h2>
            <div id="stats-container">
                <p class="loading">Cargando estad√≠sticas...</p>
            </div>
        </section>

        <!-- Backtesting -->
        <section class="card">
            <h2>üî¨ Backtesting</h2>
            <div class="form-group">
                <label class="form-label">D√≠as hist√≥ricos:</label>
                <input type="number" id="backtest-days" value="30" min="1" max="365" class="form-control">

                <label class="form-label">Capital inicial:</label>
                <input type="number" id="backtest-capital" value="10000" min="100" step="100" class="form-control">

                <button class="btn btn-warning" onclick="runBacktest()">
                    üöÄ EJECUTAR BACKTEST
                </button>
            </div>
            
            <div id="backtest-results" style="margin-top: 1.5rem;"></div>
        </section>

        <!-- Recent Signals -->
        <section class="card">
            <h2>üéØ Se√±ales Recientes</h2>
            <button class="btn btn-primary" onclick="loadRecentSignals()" style="margin-bottom: 1rem;">
                üîÑ ACTUALIZAR
            </button>
            <div id="signals-container">
                <p class="loading">Cargando se√±ales...</p>
            </div>
        </section>

        <!-- Configuration -->
        <section class="card">
            <h2>‚öôÔ∏è Configuraci√≥n</h2>
            <div id="config-container">
                <p class="loading">Cargando configuraci√≥n...</p>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>Trading Bot Dashboard v6.0 | √öltima actualizaci√≥n: <span id="last-update" class="last-update">--:--:--</span></p>
    </footer>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>